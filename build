#! /usr/bin/env bash

# build third party library
if [ ! -d src/boost/boost ]; then
    cd src/boost && ./bootstrap.sh && ./b2 headers && cd ../..
fi
if [ ! -d src/icu/build ]; then
    mkdir -p src/icu/build && cd src/icu/build && ../icu4c/source/runConfigureICU MacOSX && make -j6 check && cd ../../..
fi

# prepare build folder
DEBUG=debug
RELEASE=release
if [ ! -d $DEBUG ]; then mkdir $DEBUG; fi
if [ ! -d $RELEASE ]; then mkdir $RELEASE; fi

# build
cd $DEBUG && cmake -DCMAKE_BUILD_TYPE=Debug ../src && make VERBOSE=1 && cd ..
cd $RELEASE && cmake -DCMAKE_BUILD_TYPE=Release ../src && make VERBOSE=1 && cd ..
